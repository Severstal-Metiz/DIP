var COMPLEX_TEST="COMPLEX_TEST",HEAD_TEST="HEAD_TEST",PRSEKZ_TEST="PRSEKZ_TEST",timer,selectedAnswers=[],answerInput,answerKeyboard;document.addEventListener("DOMContentLoaded",function(){if(answerInput=document.getElementsByClassName("js-number-answer")[0])answerInput.addEventListener("input",onInputAnswer,!1),answerKeyboard=createNumberKeyboard(answerInput.id,".number-answer-keyboard",numberKeyboardTheme.primary,onChangeAnswer),answerInput.focus();showMediaContent();activateTimer();setConfirmButtonsDisable(!0)});
function getQuestionType(){return document.getElementById("questionType").value}function onInputAnswer(){answerKeyboard.setInput(answerInput.value);checkNumberAnswer()}function onChangeAnswer(a){answerInput.value=a.endsWith(".")?parseFloat(a).toFixed(1):a;checkNumberAnswer()}function setConfirmButtonsDisable(a){$(".js-confirm-answer-button").prop("disabled",a)}function showMediaContent(){var a=$("#mediaContent");a.length&&a.modal()}
function activateTimer(){var a=document.getElementById("questionReadingTime").value,b=$(".js-question-time"),c=90+60*a;if(document.getElementById("themeType").value===COMPLEX_TEST)var a=document.getElementById("testStartTime").value,e=document.getElementById("testTotalTime").value,f=(new Date).getTime(),c=e-Math.round((f-a)/1E3);var d=convertToTimer(c);b.text(d);timer=setInterval(function(){d=convertToTimer(--c);b.text(d);0>=c&&(clearInterval(timer),clearAnswers(),sendAnswers())},1E3)}
function convertToTimer(a){var b=Math.floor(a/60);a-=60*b;10>b&&(b="0"+b);10>a&&(a="0"+a);return b+":"+a}
$(document).on("click",".js-answer-button",function(){var a=getQuestionType(),b=$(this).attr("data-answer-id");"MC"===a||"TF"===a?(selectedAnswers=[],$(".js-answer-button").removeClass("button--active "),selectedAnswers.push(b)):(a=selectedAnswers.indexOf(b),-1<a?selectedAnswers.splice(a,1):selectedAnswers.push(b));0===selectedAnswers.length?setConfirmButtonsDisable(!0):setConfirmButtonsDisable(!1);$(this).toggleClass("button--active ")});$(document).on("change",".js-number-answer",function(){checkNumberAnswer()});
$(document).on("click",".js-miss-answer-button",function(){var a=document.getElementById("questionId").value,b=document.getElementById("themeId").value,c=document.getElementById("themeType").value;$.ajax({type:"POST",url:"/complex/theme/question/"+a+"/skip",success:function(){var a="";c===PRSEKZ_TEST&&(a="/prsekz/theme/"+b+"/question");c===HEAD_TEST&&(a="/head/theme/"+b+"/question");c===COMPLEX_TEST&&(a="/complex/theme/"+b+"/question");a.length&&location.replace(a)}})});
$(document).on("click",".js-confirm-answer-button",function(){clearInterval(timer);startLoading();setAnswers();sendAnswers()});function checkNumberAnswer(){0===answerInput.value.length?setConfirmButtonsDisable(!0):setConfirmButtonsDisable(!1)}function startLoading(){$(".js-confirm-answer-button").prop("disabled",!0).hide();$(".question-spinner").removeClass("d-none")}function clearAnswers(){setAnswerIds("");setNumberAnswer("")}function setAnswerIds(a){$("input[name\x3d'answerIds']").val(a)}
function setNumberAnswer(){var a=$(".js-number-answer").val();$("input[name\x3d'numberAnswer']").val(a)}function setAnswers(){"NUMG"===getQuestionType()?setNumberAnswer():setAnswerIds(selectedAnswers)}function sendAnswers(){$("#answerForm").submit()};